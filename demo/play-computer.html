<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Play against Computer - DHTML Chess</title>

    <?php
    date_default_timezone_set("Europe/Berlin");

    ?>

    <script type="text/javascript" src="../jquery/jquery-3.1.0.min.js"></script>
    <script type="text/javascript" src="../js/dhtml-chess.js?rnd=4"></script>
    <script type="text/javascript" src="../src/controller/play-stockfish-controller.js?rnd=3"></script>
    <script type="text/javascript" src="../garbochess-engine/garbochess.js"></script>
    <script type="text/javascript" src="../src/model/game.js?rnd=5"></script>
    <script type="text/javascript" src="../src/view/score/bar.js?rnd=4"></script>
    <script type="text/javascript" src="../src/view/board/gui.js?rnd=4"></script>
    <script type="text/javascript" src="../src/view/board/board.js?rnd=3"></script>
    <script type="text/javascript" src="../src/view/board/piece.js?rnd=3"></script>
    <script type="text/javascript" src="../src/view/notation/panel.js?rnd=3"></script>
    <script type="text/javascript" src="../src/view/notation/tactic-panel.js?rnd=3"></script>
    <link rel="stylesheet" href="../css-source/buttonbar/gray.css" type="text/css">
    <link rel="stylesheet" href="../css/dhtml-chess-all.css?rnd=2" type="text/css">
    <style type="text/css">
        body, html {
            width: 100%;
            height: 100%;
            font-family: arial !important;
        }
        .dhtml-chess-board-container{
            border:0;
            background-color: transparent;
        }
        .ludo-view-container{
            background-color:transparent;
        }
        .dhtml-chess-board-label-ranks-container,.dhtml-chess-board-label-files-container{
            color:#aeb0b0;

        }

        .ludo-twilight .notation-chess-move {
            color: #aeb0b0;
            display:inline-block;
            padding:2px;

        }

        .ludo-twilight span.notation-chess-move-highlighted {
            background-color: #aeb0b0;
            color: #444;
            border-radius:3px;
        }

        .ludo-twilight .dhtml-chess-board-container{

        }

        @media only screen and (max-device-width: 480px) {
            .ludo-twilight .dhtml-chess-board-container{

                border-radius:4px;

            }

        }
    </style>

</head>
<body class="ludo-twilight">
<script type="text/javascript">
    /**
     * The config values below shows the default values for path
     * - the path to dhtml-chess/router.php
     * - path to the root folder of dhtml chess.
     * These should be the path FROM this html file.
     */
    // Path to DHTML Chess router.php
    ludo.config.setUrl('../router.php');

    // Path to DHTML Chess root folder
    ludo.config.setDocumentRoot('../');



    var app = new ludo.Application({
        title:'Analysis board, DHTML Chess 3.0',
        layout:{
            type:'linear',
            orientation:'vertical'
        },
        children:[
            {
                id:'scoreBar',
                css:{
                    'margin': 5
                },
                type:'chess.view.score.Bar',
                layout:{
                    height:60
                },
                borderRadius:5,
                blackColor:'#444444',
                whiteColor:'#EEEEEE',
                markerColor:'#B71C1C',
                markerTextColor:'#FFF',
                stroke:'#222222',
                range:3
            },
            {
                layout: {
                    height: 20
                },
                css: {
                    'text-align': 'right',
                    'font-style': 'italic',
                    'font-size': '0.9em',
                    'padding-right': '4px'
                },
                html: '<a href="https://github.com/nmrugg/stockfish.js" onclick="var w = window.open(this.href); return false">' + chess.getPhrase('StockFish.JS Engine') + '</a>'
            },
            {
                id:'board',
                type:'chess.view.board.Board',
                pieceLayout:'svg_egg',
                boardLayout:'wood',
                padding:ludo.isMobile ? '1%' : '2.5%',
                labels:!ludo.isMobile,
                background:{
                    borderRadius: '1%',
                    paint:{
                        fill: '#444'
                    }
                },
                layout:{
                    weight:1
                },
                plugins:[
                    {
                        type:'chess.view.highlight.Arrow'
                    }
                ]

            },
            {
                height:50,
                css:{
                    'margin-top':5
                },
                layout:{
                    type:'linear',orientation:'horizontal'
                },
                children:[
                    { weight:1 },
                    { type:'form.Button', value:'Resign',listeners:{
                        'click' : function(){
                            controller.newGame();
                        }
                    } },
                    { weight:1 }
                ]
            },
            {
                type:'chess.view.notation.Panel',
                figurines: 'svg_bw',
                hidden:ludo.isMobile,
                layout:{
                    height:100
                },
                css:{
                    "text-align": "center"
                },
                framed:true,
                resizable:false

            }
        ]
    });

    var playerColor = 'white';

    var controller = new chess.controller.PlayStockFishController({
        stockfish:'../stockfish-js/stockfish.js',    // Path to garbochess.js, relative to this file
        playerColor:playerColor,    // Human color
        listeners:{
            'start': onNewGame,
            'engineupdate' :updateMove, //
            'gameover':onGameOver  // Function to call when game is over

        },
        'thinkingTime' : 3000 // Computers pondering time in 1/1000 seconds
    });

    function onNewGame(myColor){
        // Auto flip board, players color at the bottom
        if(myColor == 'black'){
            ludo.get('board').flipToBlack();
        }else{
            ludo.get('board').flipToWhite();
        }
    }


    function onGameOver(result){
        // result is either 1(White win), 0.5(draw) or -1(black wins)

        var message = result == 0.5 ? "The game is a draw" : result == 1 && myColor == 'white' ? "You won" : "You lost";

        new ludo.Notification({
            html : message,
            duration:5
        });

    }

    function updateMove(move){
        ludo.$('scoreBar').setScore(move.score);
    }

    // Update engines thinking time if required
    function setThinkingTime(thinkingTime){
        controller.setThinkingTime(thinkingTime);
    }

</script>


<script type="text/javascript" class="google-analytics">
    var hostname = location.hostname.toLowerCase();
    if (hostname.indexOf('dhtml-chess.com') >= 0) {
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-34147162-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    }
</script>


</body>
</html>