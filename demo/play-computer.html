<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Play against Computer - DHTML Chess</title>

    <?php
    date_default_timezone_set("Europe/Berlin");

    ?>

    <script type="text/javascript" src="../jquery/jquery-3.1.0.min.js"></script>
    <script type="text/javascript" src="../js/dhtml-chess.js?rnd=4"></script>
    <script type="text/javascript" src="../src/controller/garbochess-controller.js?rnd=3"></script>
    <script type="text/javascript" src="../garbochess-engine/garbochess.js"></script>
    <script type="text/javascript" src="../src/view/score/bar.js?rnd=4"></script>
    <script type="text/javascript" src="../src/view/board/gui.js?rnd=4"></script>
    <script type="text/javascript" src="../src/view/board/board.js?rnd=3"></script>
    <script type="text/javascript" src="../src/view/board/piece.js?rnd=3"></script>
    <link rel="stylesheet" href="../css-source/buttonbar/gray.css" type="text/css">
    <link rel="stylesheet" href="../css/dhtml-chess-all.css?rnd=2" type="text/css">
    <style type="text/css">
        body, html {
            width: 100%;
            height: 100%;
            font-family: arial !important;
        }
        .ludo-chess-board-container{
            border:0;
            background-color: transparent;
        }
        .ludo-view-container{
            background-color:transparent;
        }
        .ludo-chess-board-label-ranks-container,.ludo-chess-board-label-files-container{
            color:#aeb0b0;

        }

        .ludo-twilight .notation-chess-move {
            color: #aeb0b0;
            display:inline-block;
            padding:2px;

        }

        .ludo-twilight span.notation-chess-move-highlighted {
            background-color: #aeb0b0;
            color: #444;
            border-radius:3px;
        }

        .ludo-twilight .ludo-chess-board-container{
            background-color:#444;
            border-radius:10px;
            padding-right:25px;
            padding-top:25px;
        }

        @media only screen and (max-device-width: 480px) {
            .ludo-twilight .ludo-chess-board-container{
                padding:4px !important;
                border-radius:4px;

            }

        }
    </style>

</head>
<body class="ludo-twilight">
<script type="text/javascript">

    var app = new ludo.Application({
        title:'Analysis board, DHTML Chess 3.0',
        layout:{
            type:'linear',
            orientation:'vertical'
        },
        children:[
            {
                id:'scoreBar',
                css:{
                    'margin': 5
                },
                type:'chess.view.score.Bar',
                layout:{
                    height:60
                },
                borderRadius:5,
                blackColor:'#444444',
                whiteColor:'#EEEEEE',
                markerColor:'#B71C1C',
                markerTextColor:'#FFF',
                stroke:'#222222',
                range:3
            },
            {
                id:'board',
                type:'chess.view.board.Board',
                pieceLayout:'alphapale',
                boardLayout:'wood',
                labels:!ludo.util.isTabletOrMobile(),
                layout:{
                    weight:1
                },
                plugins:[
                    {
                        type:'chess.view.highlight.Arrow'
                    }
                ]

            },
            {
                height:50,
                layout:{
                    type:'linear',orientation:'horizontal'
                },
                children:[
                    { weight:1 },
                    { type:'form.Button', value:'Resign',listeners:{
                        'click' : function(){
                            controller.newGame();
                        }
                    } },
                    { weight:1 }
                ]
            },
            {
                type:'chess.view.notation.Panel',
                hidden:ludo.util.isTabletOrMobile(),
                layout:{
                    height:100
                },
                css:{
                    "text-align": "center"
                },
                framed:true,
                resizable:false

            }
        ]
    });

    var myColor = 'white';

    var controller = new chess.controller.GarboChessController({
        garboChess:'../garbochess/js/garbochess.js',    // Path to garbochess.js, relative to this file
        myColor:myColor,    // Human color
        listeners:{
            'start': onNewGame,
            'engineupdate' :updateMove, //
            'gameover':onGameOver  // Function to call when game is over

        },
        'thinkingTime' : 3000 // Computers pondering time in 1/1000 seconds
    });

    function onNewGame(myColor){
        // Auto flip board, players color at the bottom
        if(myColor == 'black'){
            ludo.get('board').flipToBlack();
        }else{
            ludo.get('board').flipToWhite();
        }
    }


    function onGameOver(result){
        // result is either 1(White win), 0.5(draw) or -1(black wins)

        var message = result == 0.5 ? "The game is a draw" : result == 1 && myColor == 'white' ? "You won" : "You lost";

        new ludo.Notification({
            html : message,
            duration:5
        });

    }

    function updateMove(move){
        var s = move.replace(/.*?Score:([\-0-9]+?)[^0-9].*/g, '$1');
        ludo.$('scoreBar').setScore(-(s/1000));
    }

    // Update engines thinking time if required
    function setThinkingTime(thinkingTime){
        controller.setThinkingTime(thinkingTime);
    }

</script>


<script type="text/javascript" class="google-analytics">
    var hostname = location.hostname.toLowerCase();
    if (hostname.indexOf('dhtml-chess.com') >= 0) {
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-34147162-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    }
</script>


</body>
</html>